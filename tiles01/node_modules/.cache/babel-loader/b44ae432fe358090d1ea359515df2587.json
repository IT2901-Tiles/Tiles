{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\StuartGO\\\\projects\\\\bachelorOppgave\\\\Tiles\\\\tiles01\\\\src\\\\Components\\\\AudioFieldAnimationPage.jsx\",\n    _s = $RefreshSig$();\n\n// Inspiration from this: https://matheswaaran.medium.com/nicol%C3%A1s-castano-i-think-using-a-functional-component-is-the-problem-f87d2a80dfae\nimport React, { useEffect, useState } from 'react';\nimport MicRecorder from 'mic-recorder-to-mp3';\nimport \"../CSS/Button.css\";\nimport Button from 'react-bootstrap/Button';\nconst Mp3Recorder = new MicRecorder({\n  bitRate: 128\n});\n\nfunction AudioFieldAnimationPage(props) {\n  _s();\n\n  window.AudioContext = window.AudioContext || window.webkitAudioContext;\n  const [triggerCard] = useState(props.triggerCard); // props to pass to AnimationsPreview.jsx\n\n  const [thingCard] = useState(props.thingCard); // props to pass to AnimationsPreview.jsx\n\n  const [feedbackCard] = useState(props.feedbackCard); // props to pass to AnimationsPreview.jsx\n  //const [audio, setAudio] = useState({ url: null, blob: null, chunks: null, duration: { h: 0, m: 0, s: 0 } })\n\n  const [isRecording, setRecording] = useState(false);\n  const [blobURL, setBlobURL] = useState('');\n  const [blob, setBlob] = useState('');\n  const [isBlocked, setBlocked] = useState(false);\n  const [audio, setAudio] = useState(''); //funtion to start the recording\n\n  function startRecording() {\n    if (isBlocked) {\n      console.log(\"Permission denied\");\n    } else Mp3Recorder.start().then(() => {\n      setRecording(true);\n    }).catch(e => console.error(e));\n  } //function to stop the recording\n\n\n  function stopRecording() {\n    setRecording(false);\n    Mp3Recorder.stop().getMp3().then(async ([buffer, blob]) => {\n      setBlob(blob);\n      const blobURL = URL.createObjectURL(blob);\n      setBlobURL(blobURL);\n      setRecording(false);\n      setAudio(buffer);\n    }).catch(e => console.log(e));\n  } //function to dowload the audio\n\n\n  function dowloadRecording() {\n    const element = document.createElement(\"a\");\n    const audioFile = new Blob(audio, {\n      type: blob.type,\n      lastModified: Date.now()\n    });\n    element.href = URL.createObjectURL(audioFile);\n    element.download = triggerCard + \"_\" + thingCard + \"_\" + feedbackCard + \".mp3\";\n    document.body.appendChild(element);\n    element.click();\n  } //function to check permission to record\n\n\n  function checkPermissionForAudio() {\n    if (navigator.mediaDevices === undefined) {\n      navigator.mediaDevices = {};\n    }\n\n    if (navigator.mediaDevices.getUserMedia === undefined) {\n      navigator.mediaDevices.getUserMedia = function (constraints) {\n        // First get ahold of the legacy getUserMedia, if present\n        var getUserMedia = // navigator.getUserMedia ||\n        navigator.webkitGetUserMedia || navigator.mozGetUserMedia; // Some browsers just don't implement it - return a rejected promise with an error\n        // to keep a consistent interface\n\n        if (!getUserMedia) {\n          return Promise.reject(new Error(\"getUserMedia is not implemented in this browser\"));\n        } // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n\n\n        return new Promise(function (resolve, reject) {\n          getUserMedia.call(navigator, constraints, resolve, reject);\n        });\n      };\n    }\n\n    navigator.mediaDevices.getUserMedia({\n      audio: true\n    }).then(stream => {\n      setBlocked(false);\n    }).catch(err => {\n      setBlocked(true);\n      console.log(\"Please give permission for the microphone to record audio.\");\n      console.log(err.name + \": \" + err.message);\n    });\n  }\n\n  ;\n  useEffect(() => {\n    checkPermissionForAudio();\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"AudioAreaAnimationPage\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Audio\",\n      children: /*#__PURE__*/_jsxDEV(\"audio\", {\n        //ref=\"audioSource\"\n        //initialAudio=\"test.mp3\"\n        controls: \"controls\",\n        src: blobURL || \"default.mp3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 36\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"AudioButtons\",\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        onClick: startRecording,\n        className: \"SmallButton\",\n        disabled: isRecording,\n        children: \"Record\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: stopRecording,\n        className: \"SmallButton\",\n        disabled: !isRecording,\n        children: \"Stop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: dowloadRecording,\n        className: \"SmallButton\",\n        disabled: audio === '',\n        children: \"Download\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 9\n  }, this);\n}\n\n_s(AudioFieldAnimationPage, \"za2ie+CHwLd2P1FiI+lNQYt9+HM=\");\n\n_c = AudioFieldAnimationPage;\nexport default AudioFieldAnimationPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"AudioFieldAnimationPage\");","map":{"version":3,"sources":["C:/Users/StuartGO/projects/bachelorOppgave/Tiles/tiles01/src/Components/AudioFieldAnimationPage.jsx"],"names":["React","useEffect","useState","MicRecorder","Button","Mp3Recorder","bitRate","AudioFieldAnimationPage","props","window","AudioContext","webkitAudioContext","triggerCard","thingCard","feedbackCard","isRecording","setRecording","blobURL","setBlobURL","blob","setBlob","isBlocked","setBlocked","audio","setAudio","startRecording","console","log","start","then","catch","e","error","stopRecording","stop","getMp3","buffer","URL","createObjectURL","dowloadRecording","element","document","createElement","audioFile","Blob","type","lastModified","Date","now","href","download","body","appendChild","click","checkPermissionForAudio","navigator","mediaDevices","undefined","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","Promise","reject","Error","resolve","call","stream","err","name","message"],"mappings":"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","sourcesContent":["// Inspiration from this: https://matheswaaran.medium.com/nicol%C3%A1s-castano-i-think-using-a-functional-component-is-the-problem-f87d2a80dfae\r\nimport React, { useEffect, useState } from 'react'\r\nimport MicRecorder from 'mic-recorder-to-mp3'\r\nimport \"../CSS/Button.css\"\r\nimport Button from 'react-bootstrap/Button';\r\n\r\nconst Mp3Recorder = new MicRecorder({ bitRate: 128 })\r\n\r\nfunction AudioFieldAnimationPage(props) {\r\n    window.AudioContext = window.AudioContext || window.webkitAudioContext;\r\n\r\n    const [triggerCard] = useState(props.triggerCard) // props to pass to AnimationsPreview.jsx\r\n    const [thingCard] = useState(props.thingCard) // props to pass to AnimationsPreview.jsx\r\n    const [feedbackCard] = useState(props.feedbackCard) // props to pass to AnimationsPreview.jsx\r\n    //const [audio, setAudio] = useState({ url: null, blob: null, chunks: null, duration: { h: 0, m: 0, s: 0 } })\r\n    const [isRecording, setRecording] = useState(false)\r\n    const [blobURL, setBlobURL] = useState('')\r\n    const [blob, setBlob] = useState('')\r\n    const [isBlocked, setBlocked] = useState(false)\r\n    const [audio, setAudio] = useState('')\r\n\r\n    //funtion to start the recording\r\n    function startRecording() {\r\n        if (isBlocked) {\r\n            console.log(\"Permission denied\")\r\n        } else\r\n            Mp3Recorder.start()\r\n                .then(() => { setRecording(true) })\r\n                .catch(e => console.error(e))\r\n    }\r\n\r\n    //function to stop the recording\r\n    function stopRecording() {\r\n        setRecording(false)\r\n        Mp3Recorder.stop()\r\n            .getMp3()\r\n            .then(async ([buffer, blob]) => {\r\n                setBlob(blob)\r\n                const blobURL = URL.createObjectURL(blob)\r\n                setBlobURL(blobURL)\r\n                setRecording(false)\r\n                setAudio(buffer)\r\n            })\r\n            .catch(e => console.log(e))\r\n    }\r\n\r\n    //function to dowload the audio\r\n    function dowloadRecording() {\r\n        const element = document.createElement(\"a\")\r\n        const audioFile = new Blob(audio, {\r\n            type: blob.type,\r\n            lastModified: Date.now()\r\n        })\r\n        element.href = URL.createObjectURL(audioFile)\r\n        element.download = triggerCard + \"_\" + thingCard + \"_\" + feedbackCard + \".mp3\"\r\n        document.body.appendChild(element)\r\n        element.click()\r\n    }\r\n\r\n    //function to check permission to record\r\n    function checkPermissionForAudio() {\r\n        if (navigator.mediaDevices === undefined) {\r\n            navigator.mediaDevices = {};\r\n        }\r\n        if (navigator.mediaDevices.getUserMedia === undefined) {\r\n            navigator.mediaDevices.getUserMedia = function (constraints) {\r\n                // First get ahold of the legacy getUserMedia, if present\r\n                var getUserMedia =\r\n                    // navigator.getUserMedia ||\r\n                    navigator.webkitGetUserMedia || navigator.mozGetUserMedia;\r\n\r\n                // Some browsers just don't implement it - return a rejected promise with an error\r\n                // to keep a consistent interface\r\n                if (!getUserMedia) {\r\n                    return Promise.reject(\r\n                        new Error(\"getUserMedia is not implemented in this browser\")\r\n                    );\r\n                }\r\n\r\n                // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\r\n                return new Promise(function (resolve, reject) {\r\n                    getUserMedia.call(navigator, constraints, resolve, reject);\r\n                });\r\n            };\r\n        }\r\n        navigator.mediaDevices\r\n            .getUserMedia({ audio: true })\r\n            .then(stream => {\r\n                setBlocked(false);\r\n            })\r\n            .catch(err => {\r\n                setBlocked(true);\r\n                console.log(\"Please give permission for the microphone to record audio.\");\r\n                console.log(err.name + \": \" + err.message);\r\n            });\r\n    };\r\n\r\n    useEffect(() => {\r\n        checkPermissionForAudio()\r\n    })\r\n\r\n    return (\r\n        <div className=\"AudioAreaAnimationPage\">\r\n            <div className=\"Audio\"><audio\r\n                //ref=\"audioSource\"\r\n                //initialAudio=\"test.mp3\"\r\n                controls=\"controls\"\r\n                src={blobURL || \"default.mp3\"}\r\n            /></div>\r\n            <div className=\"AudioButtons\">\r\n                <Button onClick={startRecording} className=\"SmallButton\" disabled={isRecording}>Record</Button>\r\n                <Button onClick={stopRecording} className=\"SmallButton\" disabled={!isRecording}>Stop</Button>\r\n                <Button onClick={dowloadRecording} className=\"SmallButton\" disabled={audio === ''}>Download</Button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AudioFieldAnimationPage"]},"metadata":{},"sourceType":"module"}