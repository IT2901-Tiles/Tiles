{"ast":null,"code":"'use strict';\n\nconst OperationBase = require('./operation').OperationBase;\n\nconst handleCallback = require('../utils').handleCallback;\n\nlet collection;\n\nfunction loadCollection() {\n  if (!collection) {\n    collection = require('../collection');\n  }\n\n  return collection;\n}\n\nclass CollectionsOperation extends OperationBase {\n  constructor(db, options) {\n    super(options);\n    this.db = db;\n  }\n\n  execute(callback) {\n    const db = this.db;\n    let options = this.options;\n    let Collection = loadCollection();\n    options = Object.assign({}, options, {\n      nameOnly: true\n    }); // Let's get the collection names\n\n    db.listCollections({}, options).toArray((err, documents) => {\n      if (err != null) return handleCallback(callback, err, null); // Filter collections removing any illegal ones\n\n      documents = documents.filter(doc => {\n        return doc.name.indexOf('$') === -1;\n      }); // Return the collection objects\n\n      handleCallback(callback, null, documents.map(d => {\n        return new Collection(db, db.s.topology, db.databaseName, d.name, db.s.pkFactory, db.s.options);\n      }));\n    });\n  }\n\n}\n\nmodule.exports = CollectionsOperation;","map":{"version":3,"sources":["C:/Users/StuartGO/projects/bachelorOppgave/Tiles/tiles01/node_modules/mongodb/lib/operations/collections.js"],"names":["OperationBase","require","handleCallback","collection","loadCollection","CollectionsOperation","constructor","db","options","execute","callback","Collection","Object","assign","nameOnly","listCollections","toArray","err","documents","filter","doc","name","indexOf","map","d","s","topology","databaseName","pkFactory","module","exports"],"mappings":"AAAA;;AAEA,MAAMA,aAAa,GAAGC,OAAO,CAAC,aAAD,CAAP,CAAuBD,aAA7C;;AACA,MAAME,cAAc,GAAGD,OAAO,CAAC,UAAD,CAAP,CAAoBC,cAA3C;;AAEA,IAAIC,UAAJ;;AACA,SAASC,cAAT,GAA0B;AACxB,MAAI,CAACD,UAAL,EAAiB;AACfA,IAAAA,UAAU,GAAGF,OAAO,CAAC,eAAD,CAApB;AACD;;AACD,SAAOE,UAAP;AACD;;AAED,MAAME,oBAAN,SAAmCL,aAAnC,CAAiD;AAC/CM,EAAAA,WAAW,CAACC,EAAD,EAAKC,OAAL,EAAc;AACvB,UAAMA,OAAN;AAEA,SAAKD,EAAL,GAAUA,EAAV;AACD;;AAEDE,EAAAA,OAAO,CAACC,QAAD,EAAW;AAChB,UAAMH,EAAE,GAAG,KAAKA,EAAhB;AACA,QAAIC,OAAO,GAAG,KAAKA,OAAnB;AAEA,QAAIG,UAAU,GAAGP,cAAc,EAA/B;AAEAI,IAAAA,OAAO,GAAGI,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBL,OAAlB,EAA2B;AAAEM,MAAAA,QAAQ,EAAE;AAAZ,KAA3B,CAAV,CANgB,CAOhB;;AACAP,IAAAA,EAAE,CAACQ,eAAH,CAAmB,EAAnB,EAAuBP,OAAvB,EAAgCQ,OAAhC,CAAwC,CAACC,GAAD,EAAMC,SAAN,KAAoB;AAC1D,UAAID,GAAG,IAAI,IAAX,EAAiB,OAAOf,cAAc,CAACQ,QAAD,EAAWO,GAAX,EAAgB,IAAhB,CAArB,CADyC,CAE1D;;AACAC,MAAAA,SAAS,GAAGA,SAAS,CAACC,MAAV,CAAiBC,GAAG,IAAI;AAClC,eAAOA,GAAG,CAACC,IAAJ,CAASC,OAAT,CAAiB,GAAjB,MAA0B,CAAC,CAAlC;AACD,OAFW,CAAZ,CAH0D,CAO1D;;AACApB,MAAAA,cAAc,CACZQ,QADY,EAEZ,IAFY,EAGZQ,SAAS,CAACK,GAAV,CAAcC,CAAC,IAAI;AACjB,eAAO,IAAIb,UAAJ,CACLJ,EADK,EAELA,EAAE,CAACkB,CAAH,CAAKC,QAFA,EAGLnB,EAAE,CAACoB,YAHE,EAILH,CAAC,CAACH,IAJG,EAKLd,EAAE,CAACkB,CAAH,CAAKG,SALA,EAMLrB,EAAE,CAACkB,CAAH,CAAKjB,OANA,CAAP;AAQD,OATD,CAHY,CAAd;AAcD,KAtBD;AAuBD;;AAtC8C;;AAyCjDqB,MAAM,CAACC,OAAP,GAAiBzB,oBAAjB","sourcesContent":["'use strict';\n\nconst OperationBase = require('./operation').OperationBase;\nconst handleCallback = require('../utils').handleCallback;\n\nlet collection;\nfunction loadCollection() {\n  if (!collection) {\n    collection = require('../collection');\n  }\n  return collection;\n}\n\nclass CollectionsOperation extends OperationBase {\n  constructor(db, options) {\n    super(options);\n\n    this.db = db;\n  }\n\n  execute(callback) {\n    const db = this.db;\n    let options = this.options;\n\n    let Collection = loadCollection();\n\n    options = Object.assign({}, options, { nameOnly: true });\n    // Let's get the collection names\n    db.listCollections({}, options).toArray((err, documents) => {\n      if (err != null) return handleCallback(callback, err, null);\n      // Filter collections removing any illegal ones\n      documents = documents.filter(doc => {\n        return doc.name.indexOf('$') === -1;\n      });\n\n      // Return the collection objects\n      handleCallback(\n        callback,\n        null,\n        documents.map(d => {\n          return new Collection(\n            db,\n            db.s.topology,\n            db.databaseName,\n            d.name,\n            db.s.pkFactory,\n            db.s.options\n          );\n        })\n      );\n    });\n  }\n}\n\nmodule.exports = CollectionsOperation;\n"]},"metadata":{},"sourceType":"script"}